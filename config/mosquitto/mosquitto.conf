# Mosquitto MQTT Broker Configuration for Maestra
# Optimized for IoT device communication (Arduino, Raspberry Pi, ESP32, etc.)

# =============================================================================
# LISTENERS
# =============================================================================

# Standard MQTT listener
listener 1883
protocol mqtt

# WebSocket listener for browser-based clients
listener 9001
protocol websockets

# =============================================================================
# SECURITY
# =============================================================================

# Allow anonymous connections (development mode)
# TODO: Enable authentication for production
allow_anonymous true

# Uncomment for production with authentication
# password_file /mosquitto/config/passwd
# allow_anonymous false

# =============================================================================
# PERSISTENCE
# =============================================================================

# Enable message persistence
persistence true
persistence_location /mosquitto/data/

# Autosave interval (seconds)
autosave_interval 1800

# =============================================================================
# LOGGING
# =============================================================================

log_dest file /mosquitto/log/mosquitto.log
log_dest stdout

log_type error
log_type warning
log_type notice
log_type information

# Connection messages
connection_messages true

# Log timestamp
log_timestamp true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Maximum inflight messages per client
max_inflight_messages 20

# Maximum queued messages per client
max_queued_messages 1000

# Message size limit (10MB for media/large payloads)
message_size_limit 10485760

# =============================================================================
# BRIDGE CONFIGURATION (Optional)
# =============================================================================

# Uncomment to bridge with cloud MQTT broker
# connection cloud-bridge
# address mqtt.cloud.provider.com:8883
# topic # both 0 maestra/local/ maestra/cloud/
